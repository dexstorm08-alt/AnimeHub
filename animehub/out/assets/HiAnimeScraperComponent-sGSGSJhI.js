import{j as e}from"./animation-jvELU4qo.js";import{r as s,R as a}from"./react-vendor-DxNDjNG-.js";import{d as t,S as l,H as r}from"./admin-I3YcsrSP.js";import{B as i,C as c,I as d,L as n}from"./ui-components-C5QItHIj.js";import"./services-By9PCRKQ.js";const m=()=>{const[m,o]=s.useState(!1),[x,h]=s.useState(""),[u,p]=s.useState(""),[j,g]=s.useState(1),[b,f]=s.useState(""),[N,v]=s.useState(null),[y,S]=s.useState(null),[E,w]=s.useState(null),[k,I]=s.useState([]),[C,D]=s.useState(null),[U,A]=s.useState(!1),[R,B]=s.useState(null);a.useEffect(()=>{T()},[]);const T=async()=>{try{const e=await t.getAnimeList(1,50);I(e.anime||[])}catch(e){}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"HiAnime.do Scraper"}),e.jsx(i,{onClick:async()=>{o(!0),w(null),v(null);try{await r.testScraper(),v({success:!0,streamUrl:"Test completed - check console for details",episodeData:{test:!0}})}catch(e){w(e instanceof Error?e.message:"Test failed")}finally{o(!1)}},variant:"outline",disabled:m,className:"text-sm",children:"🧪 Test Scraper"})]}),e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Anime"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Anime"}),e.jsx(d,{type:"text",placeholder:"Search anime...",value:x,onChange:e=>h(e.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anime ID (UUID)"}),e.jsx(d,{type:"text",placeholder:"Anime UUID from database",value:u,onChange:e=>p(e.target.value),className:"w-full"})]})]}),k.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or select from existing anime:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border rounded-md",children:k.slice(0,10).map(s=>e.jsxs("button",{onClick:()=>(e=>{D(e),h(e.title),p(e.id)})(s),className:"w-full text-left px-3 py-2 hover:bg-gray-100 border-b last:border-b-0 "+(C?.id===s.id?"bg-blue-50 text-blue-700":""),children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.id]})]},s.id))})]})]}),e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Single Episode Scraping"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Episode Number"}),e.jsx(d,{type:"number",min:"1",value:j,onChange:e=>g(parseInt(e.target.value)||1),className:"w-full"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(i,{onClick:async()=>{if(x.trim()&&u.trim()){o(!0),w(null),v(null);try{const e=await r.scrapeAnimeEpisode(x,u,j,{headless:!0,timeout:3e4,retries:3});v(e),e.success||w(e.error||"Scraping failed")}catch(e){w(e instanceof Error?e.message:"Unknown error occurred")}finally{o(!1)}}else w("Please provide both anime title and anime ID")},disabled:m||!x.trim()||!u.trim(),className:"w-full",children:m?e.jsx(n,{size:"sm"}):"🎬 Scrape Episode"})})]})]}),e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Batch Episode Scraping"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Episode Range"}),e.jsx(d,{type:"text",placeholder:"e.g., 1-5, 1,3,5, or 1",value:b,onChange:e=>f(e.target.value),className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Examples: 1-5 (episodes 1 through 5), 1,3,5 (specific episodes), 1 (single episode)"})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx(i,{onClick:async()=>{if(!x.trim()||!u.trim()||!b.trim())return void w("Please provide anime title, anime ID, and episode range");let e;if(b.includes("-")){const[s,a]=b.split("-").map(Number);e=Array.from({length:a-s+1},(e,a)=>s+a)}else e=b.includes(",")?b.split(",").map(Number):[parseInt(b)];o(!0),w(null),S(null);try{const s=await r.batchScrapeEpisodes(x,u,e,{headless:!0,timeout:3e4,retries:2,delayBetweenEpisodes:3e3});S(s),s.success||w(`Batch scraping completed with ${s.summary.errorCount} errors`)}catch(s){w(s instanceof Error?s.message:"Unknown error occurred")}finally{o(!1)}},disabled:m||!x.trim()||!u.trim()||!b.trim(),variant:"secondary",className:"flex-1",children:m?e.jsx(n,{size:"sm"}):"📺 Batch Scrape"}),e.jsx(i,{onClick:async()=>{if(x&&u){o(!0),w(null),B(null);try{const e=await r.scrapeAllEpisodes(x,{maxEpisodes:50,timeout:12e4,retries:2});e.success&&e.data?(B(e.data),A(!0)):w(e.error||"Failed to scrape episodes")}catch(e){w(e instanceof Error?e.message:"Unknown error occurred")}finally{o(!1)}}else w("Please select an anime first")},disabled:m||!x.trim()||!u.trim(),variant:"primary",className:"flex-1",children:m?e.jsx(n,{size:"sm"}):"🎬 Scrape All Episodes"})]})]})]}),E&&e.jsx(c,{className:"p-6 border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"❌"}),e.jsx("div",{className:"text-red-800",children:E})]})}),N&&e.jsxs(c,{className:"p-6 border-green-200 bg-green-50",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-green-800",children:N.success?"✅ Scraping Successful":"❌ Scraping Failed"}),N.success?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:"Stream URL:"}),e.jsx("div",{className:"bg-white p-2 rounded border text-sm font-mono break-all",children:N.streamUrl})]}),N.episodeData&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:"Episode Data:"}),e.jsx("pre",{className:"bg-white p-2 rounded border text-xs overflow-auto",children:JSON.stringify(N.episodeData,null,2)})]})]}):e.jsxs("div",{className:"text-red-800",children:[e.jsx("strong",{children:"Error:"})," ",N.error]})]}),y&&e.jsxs(c,{className:"p-6 border-blue-200 bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-blue-800",children:"📊 Batch Scraping Results"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.summary.totalEpisodes}),e.jsx("div",{className:"text-sm text-blue-700",children:"Total Episodes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.summary.successCount}),e.jsx("div",{className:"text-sm text-green-700",children:"Successful"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.summary.errorCount}),e.jsx("div",{className:"text-sm text-red-700",children:"Failed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[y.summary.successRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-purple-700",children:"Success Rate"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"Episode Results:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:y.results.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded text-sm "+(s.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[e.jsxs("span",{children:["Episode ",a+1]}),e.jsx("span",{children:s.success?"✅ Success":`❌ ${s.error}`})]},a))})]})]}),e.jsxs(c,{className:"p-6 border-gray-200 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"📋 Instructions"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"1. Setup:"})," Make sure you have Playwright installed: ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"npm run install-playwright"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"2. Single Episode:"})," Enter anime title, anime ID, and episode number to scrape one episode."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"3. Batch Scraping:"})," Use episode range format (1-5, 1,3,5, or 1) to scrape multiple episodes."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"4. Anime ID:"})," Use the UUID from your anime database, not external IDs."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"5. Rate Limiting:"})," The scraper includes delays between requests to avoid being blocked."]})]})]}),U&&R&&e.jsx(l,{isOpen:U,onClose:()=>A(!1),animeId:u,animeTitle:x,scrapedEpisodes:R.scrapedEpisodes,failedEpisodes:R.failedEpisodes,summary:R.summary,onEpisodesAdded:()=>{}})]})};export{m as HiAnimeScraperComponent};
//# sourceMappingURL=HiAnimeScraperComponent-sGSGSJhI.js.map
