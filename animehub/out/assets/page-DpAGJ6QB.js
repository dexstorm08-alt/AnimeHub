import{j as e,m as s}from"./animation-jvELU4qo.js";import{r}from"./react-vendor-DxNDjNG-.js";import{A as t}from"./admin-I3YcsrSP.js";import"./ui-components-C5QItHIj.js";import"./services-By9PCRKQ.js";function l(){const[l,a]=r.useState([]),[i,d]=r.useState(!0),[n,c]=r.useState(null),[o,x]=r.useState(1),[m,h]=r.useState(0),[u,b]=r.useState("all"),[p,g]=r.useState("all"),[j,f]=r.useState(""),[w,N]=r.useState(null),[y,v]=r.useState(null),[k,_]=r.useState(null),[C,S]=r.useState(!1),U=async(e=1)=>{try{d(!0),c(null);const s=await t.getAllUsers(e,20);a(s.users),h(s.total),x(e)}catch(s){c(s instanceof Error?s.message:"Failed to fetch users")}finally{d(!1)}};r.useEffect(()=>{U()},[]);const A=async(e,s)=>{try{N(e),c(null),v(null),await t.updateUserRole(e,s),await U(o),v(`User role updated to ${s} successfully!`),setTimeout(()=>v(null),3e3)}catch(r){c(r instanceof Error?r.message:"Failed to update user role")}finally{N(null)}},F=async(e,s)=>{try{N(e),c(null),v(null),await t.updateUserSubscription(e,s),await U(o),v(`User subscription updated to ${s} successfully!`),setTimeout(()=>v(null),3e3)}catch(r){c(r instanceof Error?r.message:"Failed to update subscription")}finally{N(null)}},P=async(e,s)=>{if(window.confirm(`Are you sure you want to delete user "${s}"? This action cannot be undone.`))try{N(e),c(null),v(null),await t.deleteUser(e),await U(o),v(`User "${s}" deleted successfully!`),setTimeout(()=>v(null),3e3)}catch(r){c(r instanceof Error?r.message:"Failed to delete user")}finally{N(null)}},$=()=>{S(!1),_(null)},M=l.filter(e=>{const s="all"===u||e.role===u,r="all"===p||e.subscription_type===p,t=""===j||e.username.toLowerCase().includes(j.toLowerCase())||e.email.toLowerCase().includes(j.toLowerCase());return s&&r&&t}),D=e=>{switch(e){case"admin":return"bg-purple-100 text-purple-800";case"moderator":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},L=e=>{switch(e){case"vip":return"bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800";case"premium":return"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},T=e=>{switch(e){case"admin":return"👑";case"moderator":return"🛡️";default:return"👤"}},E=e=>{switch(e){case"vip":return"💎";case"premium":return"⭐";default:return"🆓"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage user accounts, roles, and subscriptions"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-lg",children:"👥"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-purple-600 text-lg",children:"👑"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Admins"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.filter(e=>"admin"===e.role).length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-600 text-lg",children:"⭐"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Premium Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.filter(e=>"free"!==e.subscription_type).length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 text-lg",children:"📈"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.filter(e=>e.total_watch_time&&e.total_watch_time>0).length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200 mb-6",children:[n&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:n}),y&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:y}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Users"}),e.jsx("input",{type:"text",id:"search",placeholder:"Search by username or email...",value:j,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"roleFilter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Role"}),e.jsxs("select",{id:"roleFilter",value:u,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"user",children:"User"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"subscriptionFilter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Subscription"}),e.jsxs("select",{id:"subscriptionFilter",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Subscriptions"}),e.jsx("option",{value:"vip",children:"VIP"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"free",children:"Free"})]})]})]})]}),i?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[M.map(r=>e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:r.avatar_url?e.jsx("img",{className:"h-16 w-16 rounded-full object-cover border-2 border-gray-200",src:r.avatar_url,alt:r.username}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center border-2 border-gray-200",children:e.jsx("span",{className:"text-white text-2xl font-bold",children:r.username.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r.username}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${D(r.role)}`,children:[T(r.role)," ",r.role]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${L(r.subscription_type)}`,children:[E(r.subscription_type)," ",r.subscription_type]})]}),e.jsx("p",{className:"text-gray-600 mb-3",children:r.email}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"📅"}),e.jsxs("span",{children:["Joined ",new Date(r.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"⏱️"}),e.jsx("span",{children:r.total_watch_time&&r.total_watch_time>0?`${Math.round(r.total_watch_time/3600)}h watched`:"No watch time"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"🎬"}),e.jsx("span",{children:r.anime_watched&&r.anime_watched>0?`${r.anime_watched} anime`:"No anime watched"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Role:"}),"admin"===r.role?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-md text-sm font-medium",children:"👑 Admin (Protected)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Cannot be changed"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:r.role,onChange:e=>A(r.id,e.target.value),disabled:w===r.id,className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",disabled:!0,children:"Admin (Database Only)"})]}),w===r.id&&e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Plan:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:r.subscription_type,onChange:e=>F(r.id,e.target.value),disabled:w===r.id,className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"vip",children:"VIP"})]}),w===r.id&&e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>(e=>{_(e),S(!0)})(r),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"View Profile"}),"admin"===r.role?e.jsx("button",{disabled:!0,className:"px-4 py-2 bg-gray-400 text-white rounded-lg cursor-not-allowed text-sm opacity-50",title:"Admin users cannot be deleted",children:"Delete (Protected)"}):e.jsx("button",{onClick:()=>P(r.id,r.username),disabled:w===r.id,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors text-sm",children:w===r.id?"Deleting...":"Delete"})]})]})]})},r.id)),0===M.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"👥"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),e.jsx("p",{className:"text-gray-500",children:j||"all"!==u||"all"!==p?"No users match your current filters.":"There are no users to display."})]})]}),m>20&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>U(o-1),disabled:1===o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",o," of ",Math.ceil(m/20)]}),e.jsx("button",{onClick:()=>U(o+1),disabled:o>=Math.ceil(m/20),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]}),C&&k&&e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-900/20 via-purple-900/20 to-pink-900/20 backdrop-blur-md flex items-center justify-center z-50 p-4",children:e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[e.jsx("h2",{className:"text-2xl font-bold text-white drop-shadow-lg",children:"User Profile"}),e.jsx("button",{onClick:$,className:"text-white/70 hover:text-white transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start space-x-6 mb-6",children:[e.jsx("div",{className:"flex-shrink-0",children:k.avatar_url?e.jsxs("div",{className:"relative",children:[e.jsx("img",{className:"h-24 w-24 rounded-full object-cover border-4 border-white/30 shadow-xl",src:k.avatar_url,alt:k.username}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent"})]}):e.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-blue-400/80 to-purple-500/80 backdrop-blur-sm flex items-center justify-center border-4 border-white/30 shadow-xl",children:e.jsx("span",{className:"text-white text-3xl font-bold drop-shadow-lg",children:k.username.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("h3",{className:"text-2xl font-bold text-white drop-shadow-lg",children:k.username}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium backdrop-blur-sm border border-white/20 ${D(k.role)}`,children:[T(k.role)," ",k.role]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium backdrop-blur-sm border border-white/20 ${L(k.subscription_type)}`,children:[E(k.subscription_type)," ",k.subscription_type]})]}),e.jsx("p",{className:"text-white/80 text-lg mb-4 drop-shadow-sm",children:k.email}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/10",children:[e.jsx("span",{className:"text-white/70",children:"📅"}),e.jsxs("span",{className:"text-white/90",children:["Joined ",new Date(k.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/10",children:[e.jsx("span",{className:"text-white/70",children:"⏱️"}),e.jsx("span",{className:"text-white/90",children:k.total_watch_time&&k.total_watch_time>0?`${Math.round(k.total_watch_time/3600)}h watched`:"No watch time recorded"})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/10",children:[e.jsx("span",{className:"text-white/70",children:"🎬"}),e.jsx("span",{className:"text-white/90",children:k.anime_watched&&k.anime_watched>0?`${k.anime_watched} anime watched`:"No anime watched yet"})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/10",children:[e.jsx("span",{className:"text-white/70",children:"🆔"}),e.jsx("span",{className:"font-mono text-xs text-white/90",children:k.id})]})]})]})]}),e.jsxs("div",{className:"border-t border-white/10 pt-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-white drop-shadow-lg mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["admin"!==k.role&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Change Role"}),e.jsxs("select",{value:k.role,onChange:e=>{A(k.id,e.target.value),_({...k,role:e.target.value})},disabled:w===k.id,className:"w-full px-3 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white/30 focus:border-white/30 disabled:opacity-50",children:[e.jsx("option",{value:"user",className:"bg-gray-800 text-white",children:"User"}),e.jsx("option",{value:"moderator",className:"bg-gray-800 text-white",children:"Moderator"}),e.jsx("option",{value:"admin",disabled:!0,className:"bg-gray-800 text-white",children:"Admin (Database Only)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Change Subscription"}),e.jsxs("select",{value:k.subscription_type,onChange:e=>{F(k.id,e.target.value),_({...k,subscription_type:e.target.value})},disabled:w===k.id,className:"w-full px-3 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white/30 focus:border-white/30 disabled:opacity-50",children:[e.jsx("option",{value:"free",className:"bg-gray-800 text-white",children:"Free"}),e.jsx("option",{value:"premium",className:"bg-gray-800 text-white",children:"Premium"}),e.jsx("option",{value:"vip",className:"bg-gray-800 text-white",children:"VIP"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Actions"}),e.jsxs("div",{className:"flex space-x-2",children:["admin"!==k.role&&e.jsx("button",{onClick:()=>{P(k.id,k.username),$()},disabled:w===k.id,className:"px-4 py-2 bg-red-500/80 backdrop-blur-sm text-white rounded-lg hover:bg-red-600/80 disabled:opacity-50 transition-all duration-200 border border-red-400/30 hover:border-red-400/50",children:"Delete User"}),e.jsx("button",{onClick:$,className:"px-4 py-2 bg-white/10 backdrop-blur-sm text-white rounded-lg hover:bg-white/20 transition-all duration-200 border border-white/20 hover:border-white/30",children:"Close"})]})]})]})]})]})]})})]})}export{l as default};
//# sourceMappingURL=page-DpAGJ6QB.js.map
