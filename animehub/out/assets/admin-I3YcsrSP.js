import{j as e,A as t,m as r}from"./animation-jvELU4qo.js";import{r as a}from"./react-vendor-DxNDjNG-.js";import{s,i,I as n,B as l,S as o,L as c,C as d}from"./ui-components-C5QItHIj.js";class m{static async isAdmin(){try{const{data:{user:e}}=await s.auth.getUser();if(!e)return!1;const{data:t}=await s.from("users").select("role, is_admin").eq("id",e.id).single();return!(!t?.is_admin&&"admin"!==t?.role)}catch(e){return!1}}static async getAdminStats(){try{const[e,t,r,a,i,n]=await Promise.all([s.from("users").select("id",{count:"exact"}),s.from("anime").select("id",{count:"exact"}),s.from("episodes").select("id",{count:"exact"}),s.from("reviews").select("id",{count:"exact"}),s.from("users").select("id",{count:"exact"}).gte("created_at",new Date(Date.now()-6048e5).toISOString()),s.from("users").select("id",{count:"exact"}).neq("subscription_type","free")]),l=await s.from("user_progress").select("user_id",{count:"exact"}).gte("last_watched",new Date(Date.now()-864e5).toISOString()),o=await s.from("user_progress").select("progress_seconds"),c=o.data?.reduce((e,t)=>e+(t.progress_seconds||0),0)||0,d=Math.round(c/3600);return{totalUsers:e.count||0,totalAnime:t.count||0,totalEpisodes:r.count||0,totalReviews:a.count||0,recentUsers:i.count||0,activeUsers:l.count||0,premiumUsers:n.count||0,totalWatchTime:`${d} hours`}}catch(e){throw new Error("Failed to fetch admin statistics")}}static async getAllUsers(e=1,t=20){try{const r=(e-1)*t,{data:a,count:i,error:n}=await s.from("users").select("\n          id,\n          email,\n          username,\n          avatar_url,\n          subscription_type,\n          role,\n          is_admin,\n          created_at\n        ",{count:"exact"}).order("created_at",{ascending:!1}).range(r,r+t-1);if(n)throw n;const l=a?.map(e=>e.id)||[],[o,c]=await Promise.all([s.from("user_progress").select("user_id, progress_seconds").in("user_id",l),s.from("user_progress").select("user_id, episode_id").in("user_id",l).eq("is_completed",!0)]),d=new Map;o.data?.forEach(e=>{const t=d.get(e.user_id)||{watchTime:0,animeWatched:0};d.set(e.user_id,{...t,watchTime:t.watchTime+(e.progress_seconds||0)})}),c.data?.forEach(e=>{const t=d.get(e.user_id)||{watchTime:0,animeWatched:0};d.set(e.user_id,{...t,animeWatched:t.animeWatched+1})});return{users:a?.map(e=>({...e,total_watch_time:d.get(e.id)?.watchTime||0,anime_watched:d.get(e.id)?.animeWatched||0}))||[],total:i||0}}catch(r){throw new Error("Failed to fetch users")}}static async updateUser(e,t){try{const{data:r,error:a}=await s.from("users").update({...t,updated_at:(new Date).toISOString()}).eq("id",e).select().single();if(a)throw a;return r}catch(r){throw new Error("Failed to update user")}}static async deleteUser(e){try{const{data:t}=await s.from("users").select("role").eq("id",e).single();if("admin"===t?.role)throw new Error("Cannot delete admin users. Use database directly.");const{error:r}=await s.from("users").delete().eq("id",e);if(r)throw r;return!0}catch(t){throw new Error("Failed to delete user")}}static async getSystemHealth(){try{const e=Date.now(),{error:t}=await s.from("users").select("id").limit(1),r=Date.now()-e,a=t?"error":r>1e3?"warning":"healthy",{count:i}=await s.from("users").select("*",{count:"exact",head:!0}),n=Math.min(100,(i||0)/1e3*10),l=Math.floor(50*Math.random())+10,o=t?100:5*Math.random();return{database_status:a,api_response_time:r,storage_usage:Math.round(n),active_connections:l,error_rate:Math.round(100*o)/100}}catch(e){return{database_status:"error",api_response_time:0,storage_usage:0,active_connections:0,error_rate:100}}}static async getRecentActivity(e=10){try{const[t,r,a]=await Promise.all([s.from("users").select("id, username, email, created_at").order("created_at",{ascending:!1}).limit(e),s.from("reviews").select("\n            id, rating, created_at,\n            user:user_id (username),\n            anime:anime_id (title)\n          ").order("created_at",{ascending:!1}).limit(e),s.from("user_progress").select("\n            id, is_completed, last_watched,\n            user:user_id (username),\n            episode:episode_id (\n              title,\n              anime:anime_id (title)\n            )\n          ").order("last_watched",{ascending:!1}).limit(e)]),i=[];return t.data?.forEach(e=>{i.push({type:"user_registration",user:e.username,timestamp:e.created_at,description:`${e.username} registered`})}),r.data?.forEach(e=>{i.push({type:"review",user:e.user?.username,anime:e.anime?.title,rating:e.rating,timestamp:e.created_at,description:`${e.user?.username} rated ${e.anime?.title} ${e.rating}/10`})}),a.data?.forEach(e=>{i.push({type:e.is_completed?"episode_completed":"episode_watched",user:e.user?.username,anime:e.episode?.anime?.title,episode:e.episode?.title,timestamp:e.last_watched,description:`${e.user?.username} ${e.is_completed?"completed":"watched"} ${e.episode?.title}`})}),i.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()).slice(0,e)}catch(t){return[]}}static async createAdminUser(e,t,r){try{const{data:a,error:i}=await s.auth.admin.createUser({email:e,password:t,email_confirm:!0});if(i)throw i;const{error:n}=await s.from("users").insert({id:a.user.id,email:e,username:r,role:"admin",is_admin:!0,subscription_type:"vip"});if(n)throw n;return!0}catch(a){throw new Error("Failed to create admin user")}}static async getContentReports(e=1,t=20){try{const r=(e-1)*t,{data:a,count:i,error:n}=await s.from("content_reports").select("\n          *,\n          reporter:reported_by(username),\n          resolver:resolved_by(username)\n        ",{count:"exact"}).order("created_at",{ascending:!1}).range(r,r+t-1);if(n)throw n;return{reports:a||[],total:i||0}}catch(r){return{reports:[],total:0}}}static async updateReportStatus(e,t,r){try{const{data:{user:a}}=await s.auth.getUser();if(!a)throw new Error("Not authenticated");const{error:i}=await s.from("content_reports").update({status:t,resolved_by:a.id,resolution_notes:r,updated_at:(new Date).toISOString()}).eq("id",e);if(i)throw i;return!0}catch(a){throw new Error("Failed to update report status")}}static async createContentReport(e){try{const{error:t}=await s.from("content_reports").insert({...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()});if(t)throw t;return!0}catch(t){throw new Error("Failed to create content report")}}static async getAnalyticsData(e="7d"){try{const t="7d"===e?7:"30d"===e?30:90,r=new Date(Date.now()-24*t*60*60*1e3),{data:a}=await s.from("users").select("created_at").gte("created_at",r.toISOString()),i=new Map;a?.forEach(e=>{const t=new Date(e.created_at).toISOString().split("T")[0];i.set(t,(i.get(t)||0)+1)});const n=Array.from(i.entries()).map(([e,t])=>({date:e,users:t})),{data:l}=await s.from("anime").select("genres").not("genres","is",null),o=new Map;l?.forEach(e=>{e.genres&&e.genres.forEach(e=>{o.set(e,(o.get(e)||0)+1)})});const c=Array.from(o.entries()).map(([e,t])=>({genre:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),{data:d}=await s.from("user_watchlist").select("\n          anime_id,\n          anime:anime_id(title)\n        "),m=new Map;d?.forEach(e=>{if(e.anime&&"object"==typeof e.anime&&"title"in e.anime){const t=e.anime.title;m.set(t,(m.get(t)||0)+1)}});const u=Array.from(m.entries()).map(([e,t])=>({anime:e,views:t})).sort((e,t)=>t.views-e.views).slice(0,10);return{userGrowth:n,animeViews:u,popularGenres:c,deviceStats:[{device:"Desktop",percentage:45},{device:"Mobile",percentage:40},{device:"Tablet",percentage:15}]}}catch(t){throw new Error("Failed to fetch analytics data")}}static async getAdminSettings(){try{const{data:e,error:t}=await s.from("admin_settings").select("*").single();if(t&&"PGRST116"!==t.code)throw t;return e||{site_name:"AnimeHub",site_description:"Your ultimate anime streaming platform",maintenance_mode:!1,allow_registration:!0,max_file_size:5242880,allowed_file_types:["image/jpeg","image/png","image/gif","image/webp"],email_notifications:!0,analytics_enabled:!0,cache_enabled:!0,cache_duration:3600,social_login_enabled:!0,premium_features_enabled:!0}}catch(e){throw new Error("Failed to fetch admin settings")}}static async updateAdminSettings(e){try{const{error:t}=await s.from("admin_settings").upsert({...e,updated_at:(new Date).toISOString()});if(t)throw t;return!0}catch(t){throw new Error("Failed to update admin settings")}}static async getAllAnime(e=1,t=20){try{const r=(e-1)*t,{data:a,count:i,error:n}=await s.from("anime").select("\n          *,\n          episodes:episodes(id, title, episode_number, duration, video_url, created_at),\n          reviews:reviews(id, rating, created_at)\n        ",{count:"exact"}).order("created_at",{ascending:!1}).range(r,r+t-1);if(n)throw n;return{anime:await Promise.all(a?.map(async e=>{const{data:t}=await s.from("user_progress").select("user_id").in("episode_id",e.episodes?.map(e=>e.id)||[]).not("user_id","is",null),r=new Set(t?.map(e=>e.user_id)||[]).size;let a=null;try{const{data:t}=await s.from("content_reports").select("id").eq("content_id",e.id).eq("content_type","anime");a=t}catch(i){a=[]}return{...e,episode_count:e.episodes?.length||0,average_rating:e.reviews?.length>0?(e.reviews.reduce((e,t)=>e+t.rating,0)/e.reviews.length).toFixed(1):"N/A",total_reviews:e.reviews?.length||0,views:r,reports:a?.length||0}})||[]),total:i||0}}catch(r){throw new Error("Failed to fetch anime")}}static async createAnime(e){try{const{error:t}=await s.from("anime").insert({...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()});if(t)throw t;return!0}catch(t){throw new Error("Failed to create anime")}}static async updateAnime(e,t){try{const r=Object.entries(t).reduce((e,[t,r])=>(""===r||null==r||Array.isArray(r)&&0===r.length?e[t]=null:e[t]=r,e),{});r.updated_at=(new Date).toISOString();const{error:a}=await s.from("anime").update(r).eq("id",e);if(a)throw a;return!0}catch(r){throw new Error(`Failed to update anime: ${r instanceof Error?r.message:"Unknown error"}`)}}static async deleteAnime(e){try{const{data:t}=await s.from("episodes").select("id").eq("anime_id",e),r=t?.map(e=>e.id)||[];await Promise.all([r.length>0?s.from("user_progress").delete().in("episode_id",r):Promise.resolve(),s.from("reviews").delete().eq("anime_id",e),s.from("user_watchlist").delete().eq("anime_id",e),s.from("user_favorites").delete().eq("anime_id",e),s.from("content_reports").delete().eq("content_id",e).eq("content_type","anime"),s.from("episodes").delete().eq("anime_id",e)]);const{error:a}=await s.from("anime").delete().eq("id",e);if(a)throw a;return!0}catch(t){throw new Error("Failed to delete anime")}}static async updateAnimeStatus(e,t){try{const{error:r}=await s.from("anime").update({status:t,updated_at:(new Date).toISOString()}).eq("id",e);if(r)throw r;return!0}catch(r){throw new Error("Failed to update anime status")}}static async bulkUpdateAnimeStatus(e,t){try{const{error:r}=await s.from("anime").update({status:t,updated_at:(new Date).toISOString()}).in("id",e);if(r)throw r;return!0}catch(r){throw new Error("Failed to bulk update anime status")}}static async bulkDeleteAnime(e){try{const{data:t}=await s.from("episodes").select("id").in("anime_id",e),r=t?.map(e=>e.id)||[];await Promise.all([r.length>0?s.from("user_progress").delete().in("episode_id",r):Promise.resolve(),s.from("reviews").delete().in("anime_id",e),s.from("user_watchlist").delete().in("anime_id",e),s.from("user_favorites").delete().in("anime_id",e),s.from("content_reports").delete().in("content_id",e).eq("content_type","anime"),s.from("episodes").delete().in("anime_id",e)]);const{error:a}=await s.from("anime").delete().in("id",e);if(a)throw a;return!0}catch(t){throw new Error("Failed to bulk delete anime")}}static async getAnimeEpisodes(e){try{const{data:t,error:r}=await s.from("episodes").select("id, episode_number, title, description, duration, thumbnail_url, video_url, created_at").eq("anime_id",e).order("episode_number",{ascending:!0}).limit(50);if(r)throw r;return t||[]}catch(t){throw new Error("Failed to fetch episodes")}}static async createEpisode(e){try{const{error:t}=await s.from("episodes").insert({...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()});if(t)throw t;return!0}catch(t){throw new Error("Failed to create episode")}}static async updateEpisode(e,t){try{const{error:r}=await s.from("episodes").update({...t,updated_at:(new Date).toISOString()}).eq("id",e);if(r)throw r;return!0}catch(r){throw new Error("Failed to update episode")}}static async deleteEpisode(e){try{await Promise.all([s.from("user_progress").delete().eq("episode_id",e),s.from("reviews").delete().eq("episode_id",e)]);const{error:t}=await s.from("episodes").delete().eq("id",e);if(t)throw t;return!0}catch(t){throw new Error("Failed to delete episode")}}static async reorderEpisodes(e,t){try{const e=t.map(({id:e,episode_number:t})=>s.from("episodes").update({episode_number:t,updated_at:(new Date).toISOString()}).eq("id",e));return await Promise.all(e),!0}catch(r){throw new Error("Failed to reorder episodes")}}static async updateUserRole(e,t){try{const{data:r}=await s.from("users").select("role").eq("id",e).single();if("admin"===r?.role)throw new Error("Cannot change admin role through UI. Use database directly.");const{error:a}=await s.from("users").update({role:t,is_admin:"admin"===t}).eq("id",e);if(a)throw a;return!0}catch(r){throw new Error("Failed to update user role")}}static async updateUserSubscription(e,t){try{const{error:r}=await s.from("users").update({subscription_type:t}).eq("id",e);if(r)throw r;return!0}catch(r){throw new Error("Failed to update user subscription")}}static async getAnimeAnalytics(e){try{const{data:r,error:a}=await s.from("anime").select("*").eq("id",e).single();if(a)throw a;const{data:i}=await s.from("episodes").select("id, title, episode_number, duration, video_url, created_at").eq("anime_id",e).order("episode_number",{ascending:!0}),{data:n}=await s.from("reviews").select("id, rating, review_text, created_at, user_id").eq("anime_id",e).order("created_at",{ascending:!1}),{data:l}=await s.from("user_progress").select("user_id, episode_id, progress_seconds, is_completed, last_watched").in("episode_id",i?.map(e=>e.id)||[]);let o=null;try{const{data:t}=await s.from("content_reports").select("id, report_type, status, priority, created_at").eq("content_id",e).eq("content_type","anime");o=t}catch(t){o=[]}const c=new Set(l?.map(e=>e.user_id)||[]).size,d=l?.filter(e=>e.is_completed).length||0,m=l?.reduce((e,t)=>e+(t.progress_seconds||0),0)||0,u=n&&n.length>0?(n.reduce((e,t)=>e+t.rating,0)/n.length).toFixed(1):"N/A";return{...r,episodes:i||[],reviews:n||[],analytics:{views:c,completedViews:d,totalWatchTime:m,averageRating:u,totalReviews:n?.length||0,reports:o?.length||0,episodeCount:i?.length||0},reports:o||[]}}catch(t){throw new Error("Failed to fetch anime analytics")}}}class u{static async getAnimeList(e=1,t=20,r){try{let a=s.from("anime").select("*",{count:"exact",head:!0});r?.search&&(a=a.or(`title.ilike.%${r.search}%,title_japanese.ilike.%${r.search}%`)),r?.status&&"all"!==r.status&&(a=a.eq("status",r.status)),r?.type&&"all"!==r.type&&(a=a.eq("type",r.type)),r?.genre&&"all"!==r.genre&&(a=a.contains("genres",[r.genre]));const{count:i,error:n}=await a;if(n)return{anime:[],total:0,error:n.message};let l=s.from("anime").select("\n          *,\n          episodes (id, episode_number, title, duration, is_premium)\n        ").order("created_at",{ascending:!1});r?.search&&(l=l.or(`title.ilike.%${r.search}%,title_japanese.ilike.%${r.search}%`)),r?.status&&"all"!==r.status&&(l=l.eq("status",r.status)),r?.type&&"all"!==r.type&&(l=l.eq("type",r.type)),r?.genre&&"all"!==r.genre&&(l=l.contains("genres",[r.genre]));const o=(e-1)*t,c=o+t-1,{data:d,error:m}=await l.range(o,c);if(m)return{anime:[],total:0,error:m.message};return{anime:d?.map(e=>({...e,episode_count:e.episodes?.length||0}))||[],total:i||0,page:e,totalPages:Math.ceil((i||0)/t)}}catch(a){return{anime:[],total:0,error:"Failed to fetch anime list"}}}static async createAnime(e){try{if(!i)throw new Error("Database not configured. Please set up Supabase credentials in .env.local file.");const{data:t,error:r}=await s.from("anime").insert(e).select().single();if(r)throw new Error(`Database error: ${r.message}`);return t}catch(t){throw t}}static async updateAnime(e,t){try{const{data:r,error:a}=await s.from("anime").update({...t,updated_at:(new Date).toISOString()}).eq("id",e).select().single();return a?null:r}catch(r){return null}}static async deleteAnime(e){try{const{error:t}=await s.from("anime").delete().eq("id",e);return!t}catch(t){return!1}}static async getAnimeById(e){try{const{data:t,error:r}=await s.from("anime").select("\n          *,\n          episodes (*)\n        ").eq("id",e).single();if(r)return null;const a=t.episodes?.sort((e,t)=>e.episode_number-t.episode_number)||[];return{...t,episodes:a,episode_count:a.length}}catch(t){return null}}static async createEpisode(e){try{if(!i)throw new Error("Database not configured. Please set up Supabase credentials in .env.local file.");const{data:t,error:r}=await s.from("episodes").insert(e).select().single();if(r)throw new Error(`Database error: ${r.message}`);return t}catch(t){throw t}}static async updateEpisode(e,t){try{const{data:r,error:a}=await s.from("episodes").update(t).eq("id",e).select().single();return a?null:r}catch(r){return null}}static async deleteEpisode(e){try{const{error:t}=await s.from("episodes").delete().eq("id",e);return!t}catch(t){return!1}}static async bulkDeleteAnime(e){try{const{error:t}=await s.from("anime").delete().in("id",e);return!t}catch(t){return!1}}static async getAvailableGenres(){try{const{data:e,error:t}=await s.from("anime").select("genres").not("genres","is",null);if(t)return[];const r=e.flatMap(e=>e.genres||[]);return Array.from(new Set(r)).sort()}catch(e){return[]}}static async getAvailableStudios(){try{const{data:e,error:t}=await s.from("anime").select("studios").not("studios","is",null);if(t)return[];const r=e.flatMap(e=>e.studios||[]);return Array.from(new Set(r)).sort()}catch(e){return[]}}}function p({isOpen:s,onClose:c,onSuccess:d}){const[m,p]=a.useState({title:"",title_japanese:"",description:"",poster_url:"",banner_url:"",trailer_url:"",rating:0,year:(new Date).getFullYear(),status:"ongoing",type:"tv",genres:[],studios:[],total_episodes:1,duration:24,age_rating:"PG-13"}),[h,g]=a.useState([]),[x,b]=a.useState([]),[y,f]=a.useState(""),[j,w]=a.useState(""),[v,N]=a.useState(!1),[_,S]=a.useState(null);a.useEffect(()=>{s||(p({title:"",title_japanese:"",description:"",poster_url:"",banner_url:"",trailer_url:"",rating:0,year:(new Date).getFullYear(),status:"ongoing",type:"tv",genres:[],studios:[],total_episodes:1,duration:24,age_rating:"PG-13"}),S(null),f(""),w(""))},[s]),a.useEffect(()=>{if(s){(async()=>{try{const[e,t]=await Promise.all([u.getAvailableGenres(),u.getAvailableStudios()]);g(e),b(t)}catch(e){}})()}},[s]);const A=(e,t)=>{p(r=>({...r,[e]:t})),S(null)},k=()=>{y.trim()&&!m.genres.includes(y.trim())&&(p(e=>({...e,genres:[...e.genres,y.trim()]})),f(""))},E=()=>{j.trim()&&!m.studios.includes(j.trim())&&(p(e=>({...e,studios:[...e.studios,j.trim()]})),w(""))};return s?e.jsx(t,{children:e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:c,children:e.jsx(r.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-teal-800",children:"Add New Anime"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>{p({title:"Demon Slayer: Kimetsu no Yaiba",title_japanese:"鬼滅の刃",description:"A family is attacked by demons and only two members survive - Tanjiro and his sister Nezuko, who is turning into a demon slowly. Tanjiro sets out to become a demon slayer to avenge his family and cure his sister.",poster_url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=600&fit=crop",banner_url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=400&fit=crop",trailer_url:"https://www.youtube.com/watch?v=VQGCKyvzIM4",rating:8.7,year:2019,status:"completed",type:"tv",genres:["Action","Supernatural","Historical","Shounen"],studios:["Ufotable"],total_episodes:26,duration:24,age_rating:"R"}),S(null)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 text-sm",title:"Fill with demo data for testing",children:[e.jsx("i",{className:"ri-magic-line mr-2"}),"Demo Data"]}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]})]}),_&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-300 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-error-warning-line text-xl mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-2",children:_}),_.includes("Database not configured")&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:"To fix this:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[e.jsxs("li",{children:["Create a Supabase project at ",e.jsx("a",{href:"https://supabase.com/dashboard",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"supabase.com"})]}),e.jsxs("li",{children:["Create a ",e.jsx("code",{className:"bg-red-200 px-1 rounded",children:".env.local"})," file in your project root"]}),e.jsx("li",{children:"Add your Supabase URL and API key"}),e.jsx("li",{children:"Restart the development server"})]}),e.jsxs("p",{className:"mt-2 text-xs",children:["See ",e.jsx("code",{className:"bg-red-200 px-1 rounded",children:"SUPABASE-SETUP-GUIDE.md"})," for detailed instructions."]})]})]})]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i)if(m.title.trim()){N(!0),S(null);try{const e=await u.createAnime(m);e?(d(e),c()):S("Failed to create anime. Please check your database connection and try again.")}catch(t){t instanceof Error?S(t.message):S("Failed to create anime. Please try again.")}finally{N(!1)}}else S("Title is required");else S("Database is not configured. Please check your Supabase settings.")},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx(n,{type:"text",value:m.title,onChange:e=>A("title",e.target.value),placeholder:"Anime title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Japanese Title"}),e.jsx(n,{type:"text",value:m.title_japanese,onChange:e=>A("title_japanese",e.target.value),placeholder:"Japanese title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),e.jsx(n,{type:"number",value:m.year||"",onChange:e=>{const t=""===e.target.value?(new Date).getFullYear():parseInt(e.target.value);A("year",isNaN(t)?(new Date).getFullYear():t)},min:"1900",max:(new Date).getFullYear()+1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),e.jsx(n,{type:"number",value:m.rating||"",onChange:e=>{const t=""===e.target.value?0:parseFloat(e.target.value);A("rating",isNaN(t)?0:t)},min:"0",max:"10",step:"0.1",placeholder:"0-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:m.description,onChange:e=>A("description",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",rows:4,placeholder:"Anime description..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poster URL"}),e.jsx(n,{type:"url",value:m.poster_url,onChange:e=>A("poster_url",e.target.value),placeholder:"https://example.com/poster.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Banner URL"}),e.jsx(n,{type:"url",value:m.banner_url,onChange:e=>A("banner_url",e.target.value),placeholder:"https://example.com/banner.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trailer URL"}),e.jsx(n,{type:"url",value:m.trailer_url,onChange:e=>A("trailer_url",e.target.value),placeholder:"https://youtube.com/watch?v=..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:m.status,onChange:e=>A("status",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"upcoming",children:"Upcoming"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:m.type,onChange:e=>A("type",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[e.jsx("option",{value:"tv",children:"TV Series"}),e.jsx("option",{value:"movie",children:"Movie"}),e.jsx("option",{value:"ova",children:"OVA"}),e.jsx("option",{value:"special",children:"Special"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age Rating"}),e.jsxs("select",{value:m.age_rating,onChange:e=>A("age_rating",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[e.jsx("option",{value:"G",children:"G"}),e.jsx("option",{value:"PG",children:"PG"}),e.jsx("option",{value:"PG-13",children:"PG-13"}),e.jsx("option",{value:"R",children:"R"}),e.jsx("option",{value:"18+",children:"18+"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Episodes"}),e.jsx(n,{type:"number",value:m.total_episodes||"",onChange:e=>{const t=""===e.target.value?1:parseInt(e.target.value);A("total_episodes",isNaN(t)?1:t)},min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),e.jsx(n,{type:"number",value:m.duration||"",onChange:e=>{const t=""===e.target.value?24:parseInt(e.target.value);A("duration",isNaN(t)?24:t)},min:"1",placeholder:"24"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:m.genres.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm flex items-center gap-2",children:[t,e.jsx("button",{type:"button",onClick:()=>(e=>{p(t=>({...t,genres:t.genres.filter(t=>t!==e)}))})(t),className:"text-teal-600 hover:text-teal-800",children:e.jsx("i",{className:"ri-close-line text-sm"})})]},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"text",value:y,onChange:e=>f(e.target.value),placeholder:"Add genre",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),k())}),e.jsx(l,{type:"button",onClick:k,size:"sm",children:"Add"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Studios"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:m.studios.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm flex items-center gap-2",children:[t,e.jsx("button",{type:"button",onClick:()=>handleRemoveStudio(t),className:"text-purple-600 hover:text-purple-800",children:e.jsx("i",{className:"ri-close-line text-sm"})})]},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"text",value:j,onChange:e=>w(e.target.value),placeholder:"Add studio",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),E())}),e.jsx(l,{type:"button",onClick:E,size:"sm",children:"Add"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:c,disabled:v,children:"Cancel"}),e.jsx(l,{type:"submit",disabled:v,className:"flex items-center gap-2",children:v?e.jsx(e.Fragment,{children:e.jsx(o,{size:"sm",text:"Creating..."})}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-add-line"}),"Create Anime"]})})]})]})]})})})}):null}const h=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}));function g({isOpen:t,onClose:s,onSuccess:i,anime:n}){const[l,o]=a.useState({title:"",title_japanese:"",description:"",poster_url:"",banner_url:"",trailer_url:"",rating:"",year:"",status:"draft",type:"TV",genres:[],studios:[],total_episodes:"",duration:"",age_rating:""}),[c,d]=a.useState(!1),[u,p]=a.useState(null),[h]=a.useState(["Action","Adventure","Comedy","Drama","Fantasy","Horror","Mystery","Romance","Sci-Fi","Slice of Life","Sports","Supernatural","Thriller"]),[g]=a.useState(["Studio Ghibli","Toei Animation","Madhouse","Bones","MAPPA","Ufotable","Wit Studio","A-1 Pictures","Production I.G","Kyoto Animation"]);a.useEffect(()=>{n&&t&&o({title:n.title||"",title_japanese:n.title_japanese||"",description:n.description||"",poster_url:n.poster_url||"",banner_url:n.banner_url||"",trailer_url:n.trailer_url||"",rating:n.rating?.toString()||"",year:n.year?.toString()||"",status:n.status||"draft",type:n.type||"TV",genres:n.genres||[],studios:n.studios||[],total_episodes:n.total_episodes?.toString()||"",duration:n.duration?.toString()||"",age_rating:n.age_rating||""})},[n,t]);return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Anime"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d(!0),p(null),!l.title.trim())return p("Title is required"),void d(!1);try{const e={title:l.title||null,title_japanese:l.title_japanese||null,description:l.description||null,poster_url:l.poster_url||null,banner_url:l.banner_url||null,trailer_url:l.trailer_url||null,rating:l.rating?parseFloat(l.rating):null,year:l.year?parseInt(l.year):null,status:l.status,type:l.type,genres:l.genres.length>0?l.genres:null,studios:l.studios.length>0?l.studios:null,total_episodes:l.total_episodes?parseInt(l.total_episodes):null,duration:l.duration?parseInt(l.duration):null,age_rating:l.age_rating||null};await m.updateAnime(n.id,e),i(),s()}catch(t){const e=t instanceof Error?t.message:"Failed to update anime";p(`Update failed: ${e}`)}finally{d(!1)}},className:"p-6 space-y-6",children:[u&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:u}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:l.title,onChange:e=>o(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Anime title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Japanese Title"}),e.jsx("input",{type:"text",value:l.title_japanese,onChange:e=>o(t=>({...t,title_japanese:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Japanese title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),e.jsx("input",{type:"number",value:l.year,onChange:e=>o(t=>({...t,year:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"2024",min:"1900",max:"2030"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:l.rating,onChange:e=>o(t=>({...t,rating:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"8.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:l.status,onChange:e=>o(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:l.type,onChange:e=>o(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"TV",children:"TV"}),e.jsx("option",{value:"Movie",children:"Movie"}),e.jsx("option",{value:"OVA",children:"OVA"}),e.jsx("option",{value:"ONA",children:"ONA"}),e.jsx("option",{value:"Special",children:"Special"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Episodes"}),e.jsx("input",{type:"number",value:l.total_episodes,onChange:e=>o(t=>({...t,total_episodes:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"12",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),e.jsx("input",{type:"number",value:l.duration,onChange:e=>o(t=>({...t,duration:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"24",min:"1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:e=>o(t=>({...t,description:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Anime description..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poster URL"}),e.jsx("input",{type:"url",value:l.poster_url,onChange:e=>o(t=>({...t,poster_url:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/poster.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Banner URL"}),e.jsx("input",{type:"url",value:l.banner_url,onChange:e=>o(t=>({...t,banner_url:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/banner.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trailer URL"}),e.jsx("input",{type:"url",value:l.trailer_url,onChange:e=>o(t=>({...t,trailer_url:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"https://youtube.com/embed/..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Genres"}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-2",children:h.map(t=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:l.genres.includes(t),onChange:()=>(e=>{o(t=>({...t,genres:t.genres.includes(e)?t.genres.filter(t=>t!==e):[...t.genres,e]}))})(t),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Studios"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:g.map(t=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:l.studios.includes(t),onChange:()=>(e=>{o(t=>({...t,studios:t.studios.includes(e)?t.studios.filter(t=>t!==e):[...t.studios,e]}))})(t),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t})]},t))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:c?"Updating...":"Update Anime"})]})]})]})}):null}const x=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));class b{static JIKAN_BASE_URL="https://api.jikan.moe/v4";static ANILIST_BASE_URL="https://graphql.anilist.co";static async searchJikanAnime(e,t=20){try{const r=Math.min(t,25),a=await fetch(`${this.JIKAN_BASE_URL}/anime?q=${encodeURIComponent(e)}&limit=${r}`);if(!a.ok){if(400===a.status)throw new Error("Jikan API error: Invalid request parameters. Please check your search query and try again.");throw new Error(`Jikan API error: ${a.status}`)}return(await a.json()).data||[]}catch(r){throw new Error(`Failed to search anime: ${r instanceof Error?r.message:"Unknown error"}`)}}static async searchAniListAnime(e,t=20){try{const r="\n        query ($search: String, $perPage: Int) {\n          Page(perPage: $perPage) {\n            media(search: $search, type: ANIME) {\n              id\n              title {\n                romaji\n                english\n                native\n                userPreferred\n              }\n              description\n              format\n              status\n              startDate {\n                year\n                month\n                day\n              }\n              endDate {\n                year\n                month\n                day\n              }\n              season\n              seasonYear\n              seasonInt\n              episodes\n              duration\n              source\n              trailer {\n                id\n                site\n                thumbnail\n              }\n              coverImage {\n                extraLarge\n                large\n                medium\n                color\n              }\n              bannerImage\n              trailer {\n                id\n                site\n                thumbnail\n              }\n              genres\n              synonyms\n              averageScore\n              meanScore\n              popularity\n              trending\n              favourites\n              studios {\n                nodes {\n                  id\n                  name\n                }\n              }\n              relations {\n                edges {\n                  id\n                  relationType\n                  node {\n                    id\n                    idMal\n                    title {\n                      romaji\n                      english\n                      native\n                    }\n                    format\n                    status\n                    episodes\n                    startDate {\n                      year\n                    }\n                    coverImage {\n                      large\n                      medium\n                    }\n                  }\n                }\n              }\n              characters(sort: [ROLE, RELEVANCE], perPage: 20) {\n                edges {\n                  id\n                  role\n                  node {\n                    id\n                    name {\n                      full\n                      native\n                      alternative\n                    }\n                    image {\n                      large\n                      medium\n                    }\n                    description\n                  }\n                }\n              }\n              externalLinks {\n                id\n                url\n                site\n                type\n                language\n              }\n            }\n          }\n        }\n      ",a=await fetch(this.ANILIST_BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r,variables:{search:e,perPage:t}})});if(!a.ok)throw new Error(`AniList API error: ${a.status}`);const s=await a.json();return s.data?.Page?.media||[]}catch(r){throw new Error(`Failed to search anime: ${r instanceof Error?r.message:"Unknown error"}`)}}static mapJikanToDatabase(e){const t=e.duration?this.parseDuration(e.duration):null;return{title:e.title,title_japanese:e.title_japanese||null,description:e.synopsis||null,poster_url:e.images?.jpg?.large_image_url||e.images?.webp?.large_image_url||null,banner_url:null,trailer_url:e.trailer?.embed_url||(e.trailer?.youtube_id?`https://www.youtube.com/embed/${e.trailer.youtube_id}`:null),rating:e.score||null,year:e.year||e.aired?.prop?.from?.year||null,status:this.mapJikanStatus(e.status),type:this.mapJikanType(e.type),genres:e.genres?.map(e=>e.name)||[],studios:e.studios?.map(e=>e.name)||[],total_episodes:e.episodes||null,duration:t,age_rating:this.mapJikanRating(e.rating)}}static mapAniListToDatabase(e){const t=e.title?.english||e.title?.romaji||e.title?.native||"",r=e.startDate?.year||e.seasonYear||null,a=e.trailer?.id?this.formatTrailerUrl(e.trailer.id,e.trailer.site):null;return{title:t,title_japanese:e.title?.native||null,description:e.description?this.stripHtmlTags(e.description):null,poster_url:e.coverImage?.large||e.coverImage?.medium||null,banner_url:e.bannerImage||null,trailer_url:a,rating:e.averageScore?e.averageScore/10:null,year:r,status:this.mapAniListStatus(e.status),type:this.mapAniListType(e.format),genres:e.genres||[],studios:e.studios?.nodes?.map(e=>e.name)||[],total_episodes:e.episodes||null,duration:e.duration||null,age_rating:null}}static async importAnime(e){try{const{data:t,error:r}=await s.from("anime").select("id, title").ilike("title",e.title||"").maybeSingle();if(t)return t;const{data:a,error:i}=await s.from("anime").insert({...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}).select().single();if(i)throw new Error(`Failed to import anime: ${i.message}`);return a}catch(t){throw t}}static async bulkImportAnime(e,t="jikan",r=10){const a={success:!0,imported:0,skipped:0,errors:[],duplicates:[]};try{let i=[];i="jikan"===t?await this.searchJikanAnime(e,r):await this.searchAniListAnime(e,r);const n=3;for(let e=0;e<i.length;e+=n){const r=i.slice(e,e+n).map(async e=>{try{const r="jikan"===t?this.mapJikanToDatabase(e):this.mapAniListToDatabase(e);await this.enhanceTrailerData(r);const{data:a}=await s.from("anime").select("id").ilike("title",r.title||"").maybeSingle();if(a)return{type:"duplicate",title:r.title||"Unknown"};return await this.importAnime(r)?{type:"success",title:r.title}:{type:"duplicate",title:r.title||"Unknown"}}catch(r){return{type:"error",title:e.title||"Unknown",error:r instanceof Error?r.message:"Unknown error"}}});(await Promise.all(r)).forEach(e=>{switch(e.type){case"success":a.imported++;break;case"duplicate":a.skipped++,a.duplicates.push(e.title);break;case"error":a.errors.push(`${e.title}: ${e.error}`)}}),e+n<i.length&&await new Promise(e=>setTimeout(e,200))}return a}catch(i){return a.success=!1,a.errors.push(`Bulk import failed: ${i instanceof Error?i.message:"Unknown error"}`),a}}static mapJikanStatus(e){if(!e)return null;switch(e.toLowerCase()){case"currently airing":case"airing":return"ongoing";case"finished airing":case"finished":return"completed";case"not yet aired":case"upcoming":return"upcoming";default:return null}}static mapJikanType(e){if(!e)return null;switch(e.toLowerCase()){case"tv":default:return"tv";case"movie":return"movie";case"ova":return"ova";case"special":return"special"}}static mapJikanRating(e){if(!e)return null;switch(e.toLowerCase()){case"g - all ages":return"G";case"pg - children":return"PG";case"pg-13 - teens 13 or older":return"PG-13";case"r - 17+ (violence & profanity)":case"r+ - mild nudity":return"R";case"rx - hentai":return"18+";default:return null}}static mapAniListStatus(e){if(!e)return null;switch(e.toLowerCase()){case"releasing":return"ongoing";case"finished":return"completed";case"not yet released":return"upcoming";default:return null}}static mapAniListType(e){if(!e)return null;switch(e.toLowerCase()){case"tv":default:return"tv";case"movie":return"movie";case"ova":return"ova";case"special":return"special"}}static parseDuration(e){const t=e.match(/(\d+)\s*min/);return t?parseInt(t[1]):null}static stripHtmlTags(e){return e.replace(/<[^>]*>/g,"").replace(/&[^;]+;/g," ").trim()}static formatTrailerUrl(e,t){switch(t?.toLowerCase()){case"youtube":default:return`https://www.youtube.com/embed/${e}`;case"dailymotion":return`https://www.dailymotion.com/embed/video/${e}`;case"vimeo":return`https://player.vimeo.com/video/${e}`}}static formatTrailerWatchUrl(e,t){switch(t?.toLowerCase()){case"youtube":default:return`https://www.youtube.com/watch?v=${e}`;case"dailymotion":return`https://www.dailymotion.com/video/${e}`;case"vimeo":return`https://vimeo.com/${e}`}}static async testTrailerData(e="Attack on Titan"){try{const t=await this.searchJikanAnime(e,1);if(t.length>0){t[0]}const r=await this.searchAniListAnime(e,1);if(r.length>0){r[0]}}catch(t){}}static async getTrendingJikanAnime(e=10){try{const t=await fetch(`${this.JIKAN_BASE_URL}/top/anime?limit=${e}`);if(!t.ok)throw new Error(`Jikan API error: ${t.status}`);return(await t.json()).data||[]}catch(t){throw new Error(`Failed to fetch trending anime: ${t instanceof Error?t.message:"Unknown error"}`)}}static async getSeasonalJikanAnime(e,t,r=20){try{const a=await fetch(`${this.JIKAN_BASE_URL}/seasons/${e}/${t}?limit=${r}`);if(!a.ok)throw new Error(`Jikan API error: ${a.status}`);return(await a.json()).data||[]}catch(a){throw new Error(`Failed to fetch seasonal anime: ${a instanceof Error?a.message:"Unknown error"}`)}}static async getTrendingAniListAnime(e=10){try{const t="\n        query GetTrendingAnime($perPage: Int) {\n          Page(perPage: $perPage) {\n            media(sort: TRENDING_DESC, type: ANIME, status_in: [RELEASING, FINISHED]) {\n              id\n              idMal\n              title {\n                romaji\n                english\n                native\n              }\n              description\n              format\n              status\n              episodes\n              duration\n              genres\n              tags {\n                name\n                rank\n              }\n              averageScore\n              meanScore\n              popularity\n              trending\n              favourites\n              startDate {\n                year\n                month\n                day\n              }\n              endDate {\n                year\n                month\n                day\n              }\n              coverImage {\n                large\n                medium\n              }\n              bannerImage\n              trailer {\n                id\n                site\n                thumbnail\n              }\n              studios {\n                nodes {\n                  id\n                  name\n                }\n              }\n              relations {\n                edges {\n                  id\n                  relationType\n                  node {\n                    id\n                    idMal\n                    title {\n                      romaji\n                      english\n                    }\n                    format\n                    status\n                    episodes\n                    startDate {\n                      year\n                    }\n                    coverImage {\n                      large\n                    }\n                  }\n                }\n              }\n              characters(sort: [ROLE, RELEVANCE], perPage: 20) {\n                edges {\n                  id\n                  role\n                  node {\n                    id\n                    name {\n                      full\n                      native\n                      alternative\n                    }\n                    image {\n                      large\n                      medium\n                    }\n                    description\n                  }\n                }\n              }\n            }\n          }\n        }\n      ",r=await fetch(this.ANILIST_BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,variables:{perPage:e}})});if(!r.ok)throw new Error(`AniList API error: ${r.status}`);const a=await r.json();return a.data?.Page?.media||[]}catch(t){throw new Error(`Failed to fetch trending anime: ${t instanceof Error?t.message:"Unknown error"}`)}}static async getSeasonalAniListAnime(e,t,r=20){try{t.toLowerCase();const a="\n        query GetSeasonalAnime($year: Int, $season: MediaSeason, $perPage: Int) {\n          Page(perPage: $perPage) {\n            media(season: $season, seasonYear: $year, type: ANIME, sort: POPULARITY_DESC) {\n              id\n              idMal\n              title {\n                romaji\n                english\n                native\n              }\n              description\n              format\n              status\n              episodes\n              duration\n              genres\n              tags {\n                name\n                rank\n              }\n              averageScore\n              meanScore\n              popularity\n              trending\n              favourites\n              startDate {\n                year\n                month\n                day\n              }\n              endDate {\n                year\n                month\n                day\n              }\n              coverImage {\n                large\n                medium\n              }\n              bannerImage\n              trailer {\n                id\n                site\n                thumbnail\n              }\n              studios {\n                nodes {\n                  id\n                  name\n                }\n              }\n              relations {\n                edges {\n                  id\n                  relationType\n                  node {\n                    id\n                    idMal\n                    title {\n                      romaji\n                      english\n                    }\n                    format\n                    status\n                    episodes\n                    startDate {\n                      year\n                    }\n                    coverImage {\n                      large\n                    }\n                  }\n                }\n              }\n              characters(sort: [ROLE, RELEVANCE], perPage: 20) {\n                edges {\n                  id\n                  role\n                  node {\n                    id\n                    name {\n                      full\n                      native\n                      alternative\n                    }\n                    image {\n                      large\n                      medium\n                    }\n                    description\n                  }\n                }\n              }\n            }\n          }\n        }\n      ",s=await fetch(this.ANILIST_BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a,variables:{year:e,season:t.toUpperCase(),perPage:r}})});if(!s.ok)throw new Error(`AniList API error: ${s.status}`);const i=await s.json();return i.data?.Page?.media||[]}catch(a){throw new Error(`Failed to fetch seasonal anime: ${a instanceof Error?a.message:"Unknown error"}`)}}static async importAnimeRelations(e,t){try{if(!t.relations?.edges||0===t.relations.edges.length)return{success:0,errors:0};let a=0,i=0;for(const n of t.relations.edges)try{const r=n.node.title?.romaji||n.node.title?.english||n.node.title?.native;if(!r||!n.relationType)continue;const l=t.title?.romaji||t.title?.english||t.title?.native||"";if(l&&r){const e=l.toLowerCase().split(/\s+/),t=r.toLowerCase().split(/\s+/),a=e.some(e=>e.length>2&&t.some(t=>t.includes(e)||e.includes(t)));if(["SEQUEL","PREQUEL"].includes(n.relationType)&&!a)continue}const o={anime_id:e,related_anime_id:n.node.idMal?.toString()||n.node.id?.toString(),relation_type:n.relationType,anilist_id:n.node.id,mal_id:n.node.idMal,title:r,format:n.node.format,status:n.node.status,episodes:n.node.episodes,year:n.node.startDate?.year,poster_url:n.node.coverImage?.large||n.node.coverImage?.medium},{error:c}=await s.from("anime_relations").upsert(o,{onConflict:"anime_id,related_anime_id,relation_type",ignoreDuplicates:!0});c?i++:a++}catch(r){i++}return{success:a,errors:i}}catch(r){return{success:0,errors:1}}}static async importAnimeCharacters(e,t){try{if(!t.characters?.edges||0===t.characters.edges.length)return{success:0,errors:0};t.characters.edges.reduce((e,t)=>(e[t.role]=(e[t.role]||0)+1,e),{});let a=0,i=0;const n=t.characters.edges.filter(e=>"MAIN"===e.role);for(const t of n)try{const r={anime_id:e,name:t.node.name?.full||t.node.name?.native,name_japanese:t.node.name?.native,name_romaji:t.node.name?.alternative,role:t.role?.toLowerCase()||"supporting",image_url:t.node.image?.large||t.node.image?.medium,description:t.node.description},{error:n}=await s.from("anime_characters").upsert(r,{onConflict:"anime_id,name",ignoreDuplicates:!0});n?i++:a++}catch(r){i++}return{success:a,errors:i}}catch(r){return{success:0,errors:1}}}static async importAnimeStudios(e,t){try{if(!t.studios?.nodes||0===t.studios.nodes.length)return{success:0,errors:0};let a=0,i=0;const n=t.studios.nodes.slice(0,2);for(const t of n)try{const r={anilist_id:t.id,name:t.name},{data:n,error:l}=await s.from("anime_studios").upsert(r,{onConflict:"anilist_id"}).select("id").single();if(l){i++;continue}const o=n?.id;if(!o){i++;continue}const c={anime_id:e,studio_id:o,role:"animation"},{error:d}=await s.from("anime_studio_relations").upsert(c,{onConflict:"anime_id,studio_id,role",ignoreDuplicates:!0});d?i++:a++}catch(r){i++}return{success:a,errors:i}}catch(r){return{success:0,errors:1}}}static async updateAnimeTrailers(){try{const{data:t,error:r}=await s.from("anime").select("id, title, trailer_url").or("trailer_url.is.null,trailer_url.eq.").limit(50);if(r)return{updated:0,errors:1};if(!t||0===t.length)return{updated:0,errors:0};let a=0,i=0;for(const n of t)try{const e={id:n.id,title:n.title,trailer_url:n.trailer_url};if(await this.enhanceTrailerData(e),e.trailer_url&&e.trailer_url!==n.trailer_url){const{error:t}=await s.from("anime").update({trailer_url:e.trailer_url}).eq("id",n.id);t?i++:a++}await new Promise(e=>setTimeout(e,1e3))}catch(e){i++}return{updated:a,errors:i}}catch(e){return{updated:0,errors:1}}}static async enhanceTrailerData(e){try{if(e.trailer_url)return;try{const t=await this.searchJikanAnime(e.title,1);if(t.length>0){const r=t[0];if(r.trailer?.embed_url||r.trailer?.youtube_id){const t=r.trailer.embed_url||(r.trailer.youtube_id?`https://www.youtube.com/embed/${r.trailer.youtube_id}`:null);if(t)return void(e.trailer_url=t)}}}catch(t){}try{const t=await this.searchAniListAnime(e.title,1);if(t.length>0){const r=t[0];if(r.trailer?.id){const t=this.formatTrailerUrl(r.trailer.id,r.trailer.site);return void(e.trailer_url=t)}}}catch(t){}}catch(t){}}static async importAnimeWithRelations(e){try{const t=this.mapAniListToDatabase(e);await this.enhanceTrailerData(t);const{data:r,error:a}=await s.from("anime").insert(t).select().single();if(a)throw a;const i=r.id,[n,l,o]=await Promise.all([this.importAnimeRelations(i,e),this.importAnimeCharacters(i,e),this.importAnimeStudios(i,e)]);return{success:!0,animeId:i,relations:n,characters:l,studios:o}}catch(t){return{success:!1}}}static async importAnimeFromAniList(e){try{const t=await this.importAnimeWithRelations(e);return!!t.success&&(t.relations,t.characters,t.studios,!0)}catch(t){return!1}}}const y=()=>{const[t,r]=a.useState("Attack on Titan"),[s,i]=a.useState(!1),[o,d]=a.useState([]);return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"🎬 Trailer Debugger"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"Search query (e.g., Attack on Titan)",className:"mb-2"}),e.jsx(l,{onClick:async()=>{i(!0),d([]);try{const[e,r]=await Promise.all([b.searchJikanAnime(t,3),b.searchAniListAnime(t,3)]),a=e.map(e=>({source:"Jikan",title:e.title,originalTrailer:e.trailer,mappedTrailer:b.mapJikanToDatabase(e).trailer_url})),s=r.map(e=>({source:"AniList",title:e.title?.english||e.title?.romaji,originalTrailer:e.trailer,mappedTrailer:b.mapAniListToDatabase(e).trailer_url}));d([...a,...s]),await b.testTrailerData(t)}catch(e){}finally{i(!1)}},disabled:s,className:"w-full",children:s?e.jsx(c,{size:"sm"}):"🧪 Test Trailer Data"})]}),o.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"📊 Results:"}),o.map((t,r)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-blue-600",children:[t.source,": ",t.title]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Original Trailer:"}),e.jsx("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs overflow-auto",children:JSON.stringify(t.originalTrailer,null,2)})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("strong",{children:"Mapped Trailer URL:"}),e.jsx("div",{className:"mt-1 p-2 bg-green-100 rounded text-xs break-all",children:t.mappedTrailer||"No trailer URL"})]})]})]},r))]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔍 Debug Instructions:"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:'1. Enter an anime name (e.g., "Attack on Titan", "Demon Slayer")'}),e.jsx("li",{children:'2. Click "Test Trailer Data"'}),e.jsx("li",{children:"3. Check console logs for detailed debug info"}),e.jsx("li",{children:"4. Look at the results above to see trailer data"}),e.jsx("li",{children:'5. Check if "Mapped Trailer URL" shows embed URLs'})]})]})]})},f=Object.freeze(Object.defineProperty({__proto__:null,TrailerDebugger:y},Symbol.toStringTag,{value:"Module"})),j=()=>{const[i,o]=a.useState(""),[m,u]=a.useState([]),[p,h]=a.useState([]),[g,x]=a.useState(!1),[f,j]=a.useState(!1),[w,v]=a.useState(null),[N,_]=a.useState("jikan"),[S,A]=a.useState(!1),[k,E]=a.useState(null),[T,C]=a.useState({year:"",genre:"",status:"",rating:"",sortBy:"relevance"}),[D,P]=a.useState(5),[I,L]=a.useState(!1),[$,U]=a.useState([]),[R,O]=a.useState(!1),[F,q]=a.useState("search"),[M,J]=a.useState(null);a.useEffect(()=>{B()},[]);const B=async()=>{try{const e=JSON.parse(localStorage.getItem("animeImportHistory")||"[]");U(e)}catch(e){}},z=(e,t)=>{const r=[{id:Date.now(),query:t,result:e,timestamp:(new Date).toISOString(),source:N},...$.slice(0,9)];U(r),localStorage.setItem("animeImportHistory",JSON.stringify(r))},G=async()=>{if(i.trim()){x(!0),u([]),v(null);try{let e=[];e="jikan"===N?await b.searchJikanAnime(i,25):await b.searchAniListAnime(i,50);const t=e.map(e=>({..."jikan"===N?b.mapJikanToDatabase(e):b.mapAniListToDatabase(e),source:N,originalData:e})),r=H(t);u(r)}catch(e){alert(`Search failed: ${e instanceof Error?e.message:"Unknown error"}`)}finally{x(!1)}}},H=e=>{let t=e;if(T.year&&(t=t.filter(e=>e.year===parseInt(T.year)||e.originalData.startDate?.year===parseInt(T.year))),T.genre&&(t=t.filter(e=>e.genres?.some(e=>e.toLowerCase().includes(T.genre.toLowerCase())))),T.status&&(t=t.filter(e=>e.status?.toLowerCase().includes(T.status.toLowerCase()))),T.rating){const e=parseFloat(T.rating);t=t.filter(t=>(t.rating||t.originalData.score||t.originalData.averageScore)>=e)}return t.sort((e,t)=>{switch(T.sortBy){case"rating":return(t.rating||t.originalData.score||t.originalData.averageScore||0)-(e.rating||e.originalData.score||e.originalData.averageScore||0);case"year":return(t.year||t.originalData.startDate?.year||0)-(e.year||e.originalData.startDate?.year||0);case"title":return(e.title||"").localeCompare(t.title||"");case"popularity":return(t.originalData.popularity||t.originalData.members||0)-(e.originalData.popularity||e.originalData.members||0);default:return 0}}),t},Y=async()=>{x(!0),u([]),v(null);try{let e;if("anilist"===N){e=(await b.getTrendingAniListAnime(25)).map(e=>({...b.mapAniListToDatabase(e),source:"anilist",originalData:e}))}else{e=(await b.getTrendingJikanAnime(25)).map(e=>({...b.mapJikanToDatabase(e),source:"jikan",originalData:e}))}const t=H(e);u(t)}catch(e){alert(`Failed to fetch trending anime: ${e instanceof Error?e.message:"Unknown error"}`)}finally{x(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent mb-4",children:"🎌 Anime Import Hub"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Discover, import, and manage your anime collection with advanced features"})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6",children:e.jsx("div",{className:"flex space-x-1 bg-white/20 rounded-2xl p-1",children:[{id:"search",label:"🔍 Search Anime",icon:"🔍"},{id:"trending",label:"🔥 Trending",icon:"🔥"},{id:"seasonal",label:"🌸 Seasonal",icon:"🌸"},{id:"debug",label:"🧪 Debug",icon:"🧪"}].map(t=>e.jsxs("button",{onClick:()=>q(t.id),className:"flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-200 "+(F===t.id?"bg-white text-purple-600 shadow-lg":"text-white hover:bg-white/10"),children:[e.jsx("span",{className:"mr-2",children:t.icon}),t.label]},t.id))})}),e.jsxs("div",{className:"p-8",children:[e.jsxs(t,{mode:"wait",children:["search"===F&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"🎯 Search Query"}),e.jsx(n,{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"Search for anime (e.g., Attack on Titan, Demon Slayer)",onKeyPress:e=>"Enter"===e.key&&G(),className:"w-full px-4 py-3 rounded-xl border-2 border-blue-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all"})]}),e.jsxs("div",{className:"lg:w-48",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"📡 Data Source"}),e.jsxs("select",{value:N,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 rounded-xl border-2 border-blue-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all",children:[e.jsx("option",{value:"jikan",children:"Jikan (MyAnimeList)"}),e.jsx("option",{value:"anilist",children:"AniList"})]})]}),e.jsx("div",{className:"lg:w-32 flex items-end",children:e.jsx(l,{onClick:G,disabled:g||!i.trim(),className:"w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:g?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(c,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Searching..."})]}):"🔍 Search"})})]})})},"search"),"trending"===F&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"🔥 Trending Anime"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Discover the most popular anime right now"}),e.jsx(l,{onClick:Y,disabled:g,className:"px-8 py-4 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:g?e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Loading..."})]}):"🔥 Load Trending Anime"})]})},"trending"),"seasonal"===F&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"🌸 Current Season"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Explore anime from the current season"}),e.jsx(l,{onClick:async()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1;let a="winter";r>=3&&r<=5?a="spring":r>=6&&r<=8?a="summer":r>=9&&r<=11&&(a="fall"),x(!0),u([]),v(null);try{let e;if("anilist"===N){e=(await b.getSeasonalAniListAnime(t,a,25)).map(e=>({...b.mapAniListToDatabase(e),source:"anilist",originalData:e}))}else{e=(await b.getSeasonalJikanAnime(t,a,25)).map(e=>({...b.mapJikanToDatabase(e),source:"jikan",originalData:e}))}const r=H(e);u(r)}catch(s){alert(`Failed to fetch seasonal anime: ${s instanceof Error?s.message:"Unknown error"}`)}finally{x(!1)}},disabled:g,className:"px-8 py-4 bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:g?e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Loading..."})]}):"🌸 Load Current Season"})]})},"seasonal"),"debug"===F&&e.jsxs(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsx(y,{}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:"🎭 Characters Debug"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Test character import and check database status."}),M&&e.jsx("div",{className:"p-4 rounded-xl mb-4 "+(M.includes("Error")||M.includes("error")?"bg-red-50 border border-red-200 text-red-700":"bg-green-50 border border-green-200 text-green-700"),children:e.jsx("p",{className:"font-medium",children:M})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(l,{onClick:async()=>{try{const{data:e,error:t}=await s.from("anime_characters").select("*").limit(5);J(t?`Characters table error: ${t.message}`:`Characters table OK. Found ${e?.length||0} characters.`)}catch(e){J(`Error: ${e}`)}},className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300",children:"🔍 Check Characters Table"}),e.jsx(l,{onClick:async()=>{try{const{data:e,error:t}=await s.from("anime").select("id, title").limit(1);if(t)J(`Anime table error: ${t.message}`);else if(e&&e.length>0){const t=e[0].id,{data:r,error:a}=await s.from("anime_characters").select("*").eq("anime_id",t);J(a?`Error fetching characters: ${a.message}`:`Found ${r?.length||0} characters for "${e[0].title}"`)}else J("No anime found in database")}catch(e){J(`Error: ${e}`)}},className:"bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300",children:"👥 Check Sample Characters"}),e.jsx(l,{onClick:async()=>{try{J("Testing AniList character fetch...");const e='\n                              query {\n                                Media(search: "Attack on Titan", type: ANIME) {\n                                  id\n                                  title { romaji english native }\n                                  characters(sort: [ROLE, RELEVANCE], perPage: 50) {\n                                    edges {\n                                      id\n                                      role\n                                      node {\n                                        id\n                                        name { full native alternative }\n                                        image { large medium }\n                                        description\n                                      }\n                                    }\n                                  }\n                                }\n                              }\n                            ',t=await fetch("https://graphql.anilist.co",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),r=await t.json();if(r.data?.Media?.characters?.edges){const e=r.data.Media.characters.edges;J(`✅ AniList API working! Found ${e.length} characters for "Attack on Titan"`)}else J("❌ No characters found in AniList response")}catch(e){J(`❌ AniList API test failed: ${e}`)}},className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-2 rounded-xl font-semibold transition-all duration-300",children:"🧪 Test AniList API"})]})]})]},"debug")]}),e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx(l,{onClick:()=>O(!R),variant:"secondary",className:"px-4 py-2 rounded-xl border-2 border-purple-200 hover:border-purple-400 transition-all",children:R?"🔽 Hide Advanced":"🔼 Show Advanced"})}),e.jsx(t,{children:R&&e.jsxs(r.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-2xl p-6 border border-purple-200 overflow-hidden",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"🔧 Advanced Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),e.jsx(n,{type:"number",value:T.year,onChange:e=>C({...T,year:e.target.value}),placeholder:"2023",className:"rounded-xl border-2 border-purple-200 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Genre"}),e.jsx(n,{type:"text",value:T.genre,onChange:e=>C({...T,genre:e.target.value}),placeholder:"Action",className:"rounded-xl border-2 border-purple-200 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:T.status,onChange:e=>C({...T,status:e.target.value}),className:"w-full px-3 py-2 rounded-xl border-2 border-purple-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-200",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"upcoming",children:"Upcoming"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Rating"}),e.jsx(n,{type:"number",step:"0.1",min:"0",max:"10",value:T.rating,onChange:e=>C({...T,rating:e.target.value}),placeholder:"8.0",className:"rounded-xl border-2 border-purple-200 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),e.jsxs("select",{value:T.sortBy,onChange:e=>C({...T,sortBy:e.target.value}),className:"w-full px-3 py-2 rounded-xl border-2 border-purple-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-200",children:[e.jsx("option",{value:"relevance",children:"Relevance"}),e.jsx("option",{value:"rating",children:"Rating"}),e.jsx("option",{value:"year",children:"Year"}),e.jsx("option",{value:"title",children:"Title"}),e.jsx("option",{value:"popularity",children:"Popularity"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(l,{onClick:()=>{C({year:"",genre:"",status:"",rating:"",sortBy:"relevance"})},variant:"secondary",className:"px-4 py-2 rounded-xl",children:"🗑️ Clear Filters"}),e.jsx(l,{onClick:async()=>{i.trim()?await G():await Y()},disabled:g,className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl",children:"🔍 Apply Filters"})]})]})})]}),e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-6 border border-green-200",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"⚙️ Import Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch Size"}),e.jsx(n,{type:"number",min:"1",max:"20",value:D,onChange:e=>P(parseInt(e.target.value)||5),className:"rounded-xl border-2 border-green-200 focus:border-green-500"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:e=>L(e.target.checked),className:"w-5 h-5 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Auto Import"})]})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:e=>A(e.target.checked),className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Show Preview"})]})})]})]})}),e.jsx(t,{children:k&&e.jsx(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"mt-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"📊 Import Progress"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:["Progress: ",k.completed,"/",k.total]}),e.jsxs("span",{children:[k.percentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx(r.div,{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full",initial:{width:0},animate:{width:`${k.percentage}%`},transition:{duration:.5}})}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Currently importing: ",e.jsx("span",{className:"font-semibold text-purple-600",children:k.current})]})]})]})})}),e.jsx(t,{children:w&&e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mt-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-6 border border-green-200",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"📈 Import Results"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-100 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.imported}),e.jsx("div",{className:"text-sm text-green-700",children:"Imported"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-100 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:w.skipped}),e.jsx("div",{className:"text-sm text-yellow-700",children:"Skipped"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-100 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:w.errors.length}),e.jsx("div",{className:"text-sm text-red-700",children:"Errors"})]})]}),w.duplicates.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Duplicates found:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.duplicates.map((t,r)=>e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm",children:t},r))})]}),w.errors.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Errors:"}),e.jsx("div",{className:"space-y-1",children:w.errors.map((t,r)=>e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded-lg",children:["• ",t]},r))})]})]})})})]})]}),e.jsx(t,{children:m.length>0&&e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-8",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-2xl font-bold text-white",children:["📋 Search Results (",m.length,")"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{onClick:()=>{p.length===m.length?h([]):h([...m])},variant:"secondary",className:"bg-white/20 hover:bg-white/30 text-white border-white/30",children:p.length===m.length?"❌ Deselect All":"✅ Select All"}),e.jsx(l,{onClick:()=>A(!S),variant:"secondary",className:"bg-white/20 hover:bg-white/30 text-white border-white/30",children:S?"👁️ Hide Preview":"👁️ Show Preview"}),p.length>0&&e.jsx(l,{onClick:async()=>{if(0!==p.length){j(!0),v(null),E({total:p.length,completed:0,current:"",percentage:0});try{const e={success:!0,imported:0,skipped:0,errors:[],duplicates:[]},t=3;for(let r=0;r<p.length;r+=t){const a=p.slice(r,r+t).map(async(e,t)=>{try{const t="jikan"===e.source?b.mapJikanToDatabase(e.originalData):b.mapAniListToDatabase(e.originalData),r="anilist"===e.source?await b.importAnimeFromAniList(e.originalData):await b.importAnime(t);return{success:!!r,title:e.title,isDuplicate:!r}}catch(r){return{success:!1,title:e.title,error:r instanceof Error?r.message:"Unknown error"}}});(await Promise.all(a)).forEach((t,r)=>{E(e=>e?{...e,current:t.title,completed:e.completed+1,percentage:Math.round((e.completed+1)/e.total*100)}:null),t.success?e.imported++:t.isDuplicate?(e.skipped++,e.duplicates.push(t.title)):e.errors.push(`${t.title}: ${t.error}`)}),r+t<p.length&&await new Promise(e=>setTimeout(e,300))}v(e),z(e,i),h([]),u([])}catch(e){alert(`Import failed: ${e instanceof Error?e.message:"Unknown error"}`)}finally{j(!1),E(null)}}else alert("Please select at least one anime to import")},disabled:f,className:"bg-white text-purple-600 hover:bg-gray-50 font-semibold px-6 py-2 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Importing..."})]}):`📥 Import Selected (${p.length})`})]})]})}),e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:m.map((t,a)=>{const s=p.some(e=>e.title===t.title&&e.source===t.source);return e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"group",children:e.jsxs("div",{className:`relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border-2 ${s?"border-purple-500 shadow-purple-200":"border-gray-200 hover:border-purple-300"} overflow-hidden`,children:[t.poster_url&&e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:t.poster_url,alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:e=>{e.currentTarget.style.display="none"}}),e.jsx("div",{className:"absolute top-2 right-2 bg-black/50 text-white px-2 py-1 rounded-lg text-xs",children:t.source.toUpperCase()}),s&&e.jsx("div",{className:"absolute top-2 left-2 bg-purple-500 text-white p-2 rounded-full",children:"✓"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-2 line-clamp-2 group-hover:text-purple-600 transition-colors",children:t.title}),t.title_japanese&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-1",children:t.title_japanese}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t.year&&e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:t.year}),t.type&&e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full",children:t.type})]}),t.rating&&e.jsxs("div",{className:"flex items-center text-yellow-600",children:[e.jsx("span",{className:"text-xs",children:"⭐"}),e.jsxs("span",{className:"font-semibold ml-1",children:[t.rating,"/10"]})]})]}),t.genres&&t.genres.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:t.genres.slice(0,3).map((t,r)=>e.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:t},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:()=>(e=>{h(t=>t.some(t=>t.title===e.title&&t.source===e.source)?t.filter(t=>!(t.title===e.title&&t.source===e.source)):[...t,e])})(t),className:"flex-1 px-3 py-2 rounded-xl font-medium transition-all "+(s?"bg-purple-500 text-white hover:bg-purple-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:s?"✅ Selected":"📋 Select"}),e.jsx(l,{onClick:()=>(async e=>{j(!0),v(null);try{const t="jikan"===e.source?b.mapJikanToDatabase(e.originalData):b.mapAniListToDatabase(e.originalData);if("anilist"===e.source?await b.importAnimeFromAniList(e.originalData):await b.importAnime(t)){const t={success:!0,imported:1,skipped:0,errors:[],duplicates:[]};v(t),z(t,e.title),u(t=>t.filter(t=>!(t.title===e.title&&t.source===e.source)))}else v({success:!1,imported:0,skipped:1,errors:[],duplicates:[e.title]})}catch(t){v({success:!1,imported:0,skipped:0,errors:[`${e.title}: ${t instanceof Error?t.message:"Unknown error"}`],duplicates:[]})}finally{j(!1)}})(t),disabled:f,className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white rounded-xl font-medium transition-all transform hover:scale-105",children:"📥"})]}),S&&t.description&&e.jsx(r.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:t.description})})]})]})},`${t.title}-${t.source}-${a}`)})})})]})})}),e.jsx(t,{children:$.length>0&&e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"mt-8",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-600 to-gray-800 p-6",children:e.jsx("h3",{className:"text-2xl font-bold text-white",children:"📚 Recent Import History"})}),e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"space-y-4",children:$.slice(0,5).map((t,a)=>e.jsxs(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"flex justify-between items-center p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl border border-gray-200 hover:shadow-lg transition-all",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:t.query}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(t.timestamp).toLocaleString()," • ",t.source.toUpperCase()]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"✅ ",t.result.imported]}),e.jsxs("span",{className:"flex items-center text-yellow-600",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full mr-2"}),"⚠️ ",t.result.skipped]}),e.jsxs("span",{className:"flex items-center text-red-600",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-2"}),"❌ ",t.result.errors.length]})]})]},t.id))})})]})})})]})})},w=Object.freeze(Object.defineProperty({__proto__:null,EnhancedAnimeImporter:j},Symbol.toStringTag,{value:"Module"}));class v{static API_BASE_URL="http://localhost:3001";static async scrapeAnimeEpisode(e,t,r=1,a={}){try{const s=await fetch(`${this.API_BASE_URL}/api/scrape-episode`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeTitle:e,animeId:t,episodeNumber:r,options:a})});if(!s.ok){const e=await s.json();throw new Error(e.error||`Server error: ${s.status}`)}return await s.json()}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}static async scrapeAllEpisodes(e,t={}){try{const r=await fetch(`${this.API_BASE_URL}/api/scrape-all-episodes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeTitle:e,animeId:t.animeId,maxEpisodes:t.maxEpisodes||20,timeout:t.timeout||6e4,retries:t.retries||2})});if(!r.ok){const e=await r.json();throw new Error(e.error||`Server error: ${r.status}`)}return await r.json()}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}static async addScrapedEpisode(e,t){try{const r=await fetch(`${this.API_BASE_URL}/api/add-scraped-episode`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:e,episodeData:t})});if(!r.ok){const e=await r.json();throw new Error(e.error||`Server error: ${r.status}`)}return await r.json()}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}static async batchScrapeEpisodes(e,t,r,a={}){try{const s=await fetch(`${this.API_BASE_URL}/api/batch-scrape-episodes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeTitle:e,animeId:t,episodeNumbers:r,options:a})});if(!s.ok){const e=await s.json();throw new Error(e.error||`Server error: ${s.status}`)}return await s.json()}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error",results:[],summary:{totalEpisodes:r.length,successCount:0,errorCount:r.length,successRate:0}}}}static async testScraper(){}}const N=Object.freeze(Object.defineProperty({__proto__:null,HiAnimeScraperService:v},Symbol.toStringTag,{value:"Module"})),_=({isOpen:t,onClose:s,animeId:i,animeTitle:n,scrapedEpisodes:l,failedEpisodes:o,summary:c,onEpisodesAdded:d})=>{const[m,u]=a.useState(new Set),[p,h]=a.useState(new Set),[g,x]=a.useState(null),[b,y]=a.useState(null),f=async e=>{try{u(t=>new Set(t).add(e.number)),x(null);const t=await v.addScrapedEpisode(i,{number:e.number,title:e.title,streamUrl:e.streamUrl,embeddingProtected:e.embeddingProtected,embeddingReason:e.embeddingReason});t.success?(h(t=>new Set(t).add(e.number)),y(t.message||`Episode ${e.number} added successfully!`),setTimeout(()=>y(null),3e3),d()):(x(t.error||"Failed to add episode"),setTimeout(()=>x(null),5e3))}catch(t){x(t instanceof Error?t.message:"Unknown error"),setTimeout(()=>x(null),5e3)}finally{u(t=>{const r=new Set(t);return r.delete(e.number),r})}},j=e=>e?"⚠️":"✅";return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Scraped Episodes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:n})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.total}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Episodes"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.successful}),e.jsx("div",{className:"text-sm text-green-600",children:"Successfully Scraped"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.failed}),e.jsx("div",{className:"text-sm text-red-600",children:"Failed"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.embeddingProtected}),e.jsx("div",{className:"text-sm text-yellow-600",children:"Embedding Protected"})]})]})}),g&&e.jsx("div",{className:"mx-6 mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:g}),b&&e.jsx("div",{className:"mx-6 mt-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:b}),e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Episodes"}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:async()=>{const e=l.filter(e=>!p.has(e.number));for(const t of e)await f(t),await new Promise(e=>setTimeout(e,500))},disabled:l.every(e=>p.has(e.number))||m.size>0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m.size>0?"Adding...":"Add All Episodes"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[l.map(t=>{return e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-sm",children:t.number}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:t.title}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(a=t.embeddingProtected,a?"text-red-600 bg-red-100":"text-green-600 bg-green-100"),children:[j(t.embeddingProtected)," ",t.embeddingProtected?"Protected":"Embeddable"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"break-all",children:[e.jsx("strong",{children:"URL:"})," ",t.streamUrl]}),t.embeddingReason&&e.jsxs("div",{className:"mt-1",children:[e.jsx("strong",{children:"Protection Reason:"})," ",t.embeddingReason]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("strong",{children:"Scraped:"})," ",new Date(t.scrapedAt).toLocaleString()]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:p.has(t.number)?e.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-700 rounded-lg text-sm font-medium",children:"✅ Added"}):e.jsx("button",{onClick:()=>f(t),disabled:m.has(t.number),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:m.has(t.number)?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Adding..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"➕"}),e.jsx("span",{children:"Add Episode"})]})})})]})},t.number);var a}),0===l.length&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"📺"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Episodes Scraped"}),e.jsx("p",{className:"text-gray-500",children:"Try scraping again or check if the anime exists on 9anime.org.lv"})]})]}),o.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Failed Episodes"}),e.jsx("div",{className:"space-y-2",children:o.map(t=>e.jsx("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-red-900",children:["Episode ",t.number,": ",t.title]}),e.jsx("div",{className:"text-sm text-red-600 mt-1",children:t.error})]})})},t.number))})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx("button",{onClick:s,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})})]})}):null},S=Object.freeze(Object.defineProperty({__proto__:null,ScrapedEpisodesModal:_},Symbol.toStringTag,{value:"Module"})),A=()=>{const[t,s]=a.useState(!1),[i,o]=a.useState([]),[m,p]=a.useState([]),[h,g]=a.useState(""),[x,b]=a.useState(null),[y,f]=a.useState(1),[j,w]=a.useState(""),[N,S]=a.useState(null),[A,k]=a.useState(null),[E,T]=a.useState(null),[C,D]=a.useState(null),[P,I]=a.useState(!1),[L,$]=a.useState(null),[U,R]=a.useState(0),[O,F]=a.useState([]),[q,M]=a.useState(new Set);a.useEffect(()=>{J()},[]),a.useEffect(()=>{if(""===h.trim())p(i);else{const e=i.filter(e=>e.title.toLowerCase().includes(h.toLowerCase()));p(e)}},[h,i]);const J=async()=>{try{s(!0);const e=await u.getAnimeList(1,1e3);o(e.anime||[]),p(e.anime||[])}catch(e){T("Failed to load anime list")}finally{s(!1)}},B=async e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))try{const t=await fetch(`http://localhost:3001/api/anime/${e}/episodes`);if(t.ok){const e=t.headers.get("content-type");if(e&&e.includes("application/json")){const e=await t.json(),r=new Set(e.episodes?.map(e=>e.episode_number)||[]);M(r)}}}catch(t){}},z=()=>{I(!1),$(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"🎬 Anime Episode Scraper"}),e.jsx("p",{className:"text-gray-600",children:"Scrape episodes from 9anime.org.lv for your anime collection"})]}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"📺 Select Anime"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Anime"}),e.jsx(n,{type:"text",placeholder:"Type anime name to search...",value:h,onChange:e=>g(e.target.value),className:"w-full"})]}),x&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[x.poster_url&&e.jsx("img",{src:x.poster_url,alt:x.title,className:"w-16 h-20 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800",children:x.title}),e.jsxs("p",{className:"text-sm text-blue-600",children:[x.total_episodes," episodes • ",x.status]})]})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:t?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(c,{size:"sm"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading anime..."})]}):0===m.length?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No anime found"}):e.jsx("div",{className:"divide-y divide-gray-200",children:m.map(t=>e.jsx(r.div,{whileHover:{backgroundColor:"#f8fafc"},className:"p-3 cursor-pointer transition-colors "+(x?.id===t.id?"bg-blue-50":""),onClick:()=>(async e=>{b(e),g(e.title),T(null),D(null),S(null),k(null),F([]),R(0),await B(e.id)})(t),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[t.poster_url&&e.jsx("img",{src:t.poster_url,alt:t.title,className:"w-12 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.total_episodes," episodes • ",t.status]})]}),x?.id===t.id&&e.jsx("div",{className:"text-blue-600",children:e.jsx("i",{className:"ri-check-line text-xl"})})]})},t.id))})})]})]}),x&&e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"🎯 Scraping Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Single Episode"}),e.jsx(n,{type:"number",placeholder:"Episode number",value:y,onChange:e=>f(parseInt(e.target.value)||1),min:"1"}),e.jsx(l,{onClick:async()=>{if(x){s(!0),T(null),D(null);try{const e=await v.scrapeAnimeEpisode(x.title,x.id,y);S(e),e.success?(D(`Episode ${y} scraped successfully!`),setTimeout(()=>D(null),3e3)):(T(e.error||"Scraping failed"),setTimeout(()=>T(null),5e3))}catch(e){T(e instanceof Error?e.message:"Unknown error occurred"),setTimeout(()=>T(null),5e3)}finally{s(!1)}}else T("Please select an anime first")},disabled:t,className:"w-full",children:t?e.jsx(c,{size:"sm"}):"🎬 Scrape Episode"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Batch Episodes"}),e.jsx(n,{type:"text",placeholder:"1-5, 1,3,5, or 1",value:j,onChange:e=>w(e.target.value)}),e.jsx(l,{onClick:async()=>{if(!x)return void T("Please select an anime first");let e;if(j.includes("-")){const[t,r]=j.split("-").map(Number);e=Array.from({length:r-t+1},(e,r)=>t+r)}else e=j.includes(",")?j.split(",").map(Number):[parseInt(j)];s(!0),T(null),D(null),k(null);try{const t=await v.batchScrapeEpisodes(x.title,x.id,e,{headless:!0,timeout:3e4,retries:2,delayBetweenEpisodes:3e3});if(t.success&&t.results){const r=t.results.filter(e=>"success"===e.status).map(e=>({number:e.episode,title:e.title,streamUrl:e.url,embeddingProtected:e.embeddingProtected||!1,embeddingReason:e.embeddingReason||null,scrapedAt:e.scrapedAt||(new Date).toISOString(),isExisting:q.has(e.episode)}));F(r),D(`Batch scraping completed: ${r.length}/${e.length} episodes scraped successfully!`),setTimeout(()=>D(null),5e3)}else T(t.error||"Batch scraping failed"),setTimeout(()=>T(null),5e3)}catch(t){T(t instanceof Error?t.message:"Unknown error occurred"),setTimeout(()=>T(null),5e3)}finally{s(!1)}},disabled:t,className:"w-full",children:t?e.jsx(c,{size:"sm"}):"📺 Batch Scrape"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"All Episodes"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Scrape all ",x.total_episodes," episodes"]}),e.jsx(l,{onClick:async()=>{if(x){s(!0),T(null),D(null);try{const e=await v.scrapeAllEpisodes(x.title,{animeId:x.id,maxEpisodes:x.total_episodes||50});e.success&&e.data?($(e.data),I(!0),D(`Scraped ${e.data.summary?.successful||0} episodes successfully!`),setTimeout(()=>D(null),5e3)):(T(e.error||"Scraping failed"),setTimeout(()=>T(null),5e3))}catch(e){T(e instanceof Error?e.message:"Unknown error occurred"),setTimeout(()=>T(null),5e3)}finally{s(!1)}}else T("Please select an anime first")},disabled:t,className:"w-full",children:t?e.jsx(c,{size:"sm"}):"🚀 Scrape All"})]})]})]}),(N||A||E||C||O.length>0)&&e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"📊 Scraping Results"}),e.jsxs(l,{onClick:()=>{S(null),k(null),T(null),D(null),R(0),F([])},variant:"secondary",size:"sm",className:"text-gray-600 hover:text-gray-800",children:[e.jsx("i",{className:"ri-close-line mr-1"}),"Clear Results"]})]}),C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-line text-green-600 text-xl mr-2"}),e.jsx("span",{className:"text-green-800",children:C})]})}),E&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line text-red-600 text-xl mr-2"}),e.jsx("span",{className:"text-red-800",children:E})]})}),N&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"🎬 Single Episode Result"}),e.jsx("div",{className:"p-4 rounded-lg "+(N.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:N.success?e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 font-medium",children:"✅ Episode scraped successfully!"}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Stream URL: ",N.streamUrl?.substring(0,50),"..."]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[e.jsxs("p",{children:["Episode: ",y]}),e.jsxs("p",{children:["Anime: ",x?.title]})]})]}):e.jsxs("div",{children:[e.jsxs("p",{className:"text-red-800",children:["❌ ",N.error]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[e.jsxs("p",{children:["Episode: ",y]}),e.jsxs("p",{children:["Anime: ",x?.title]})]})]})})]}),A&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"📺 Batch Scraping Result"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:A.summary.totalEpisodes}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Episodes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:A.summary.successCount}),e.jsx("div",{className:"text-sm text-gray-600",children:"Successfully Scraped"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:A.summary.errorCount}),e.jsx("div",{className:"text-sm text-gray-600",children:"Failed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[A.summary.successRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Success Rate"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Episodes Range:"})," ",j]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Anime:"})," ",x?.title]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Scraped At:"})," ",(new Date).toLocaleString()]})]})]})]}),O.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"🎬 Scraped Episodes"}),e.jsx("div",{className:"space-y-2",children:O.map(t=>e.jsx("div",{className:"p-3 rounded-lg border "+(t.isExisting?"bg-gray-50 border-gray-200":"bg-blue-50 border-blue-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"font-medium text-gray-800",children:["Episode ",t.number]}),e.jsx("span",{className:"text-sm text-gray-600",children:t.title}),t.embeddingProtected&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:"Protected"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Stream URL: ",t.streamUrl?.substring(0,50),"..."]})]}),e.jsx("div",{className:"ml-4",children:t.isExisting?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx("i",{className:"ri-check-line mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Added"})]}):e.jsxs(l,{onClick:()=>(async e=>{if(x)try{const t=await fetch("http://localhost:3001/api/add-scraped-episode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:x.id,episodeData:{number:e.number,title:e.title,streamUrl:e.streamUrl,description:"Scraped from HiAnime",isPremium:!1}})}),r=await t.json();r.success?(F(t=>t.map(t=>t.number===e.number?{...t,isExisting:!0,addedAt:(new Date).toISOString()}:t)),M(t=>new Set([...t,e.number])),R(e=>e+1),D(`Episode ${e.number} added successfully!`),setTimeout(()=>D(null),3e3)):(T(r.error||"Failed to add episode"),setTimeout(()=>T(null),5e3))}catch(t){T("Error adding episode"),setTimeout(()=>T(null),5e3)}})(t),size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Add"]})})]})},t.number))})]}),U>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"✅ Episodes Added to Database"}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-line text-green-600 text-xl mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-green-800 font-medium",children:[U," episodes successfully added to database!"]}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Anime: ",x?.title]})]})]})})]})]}),e.jsxs(d,{className:"p-6 bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"📋 How to Use"}),e.jsxs("div",{className:"space-y-2 text-blue-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1. Search & Select:"})," Search for your anime and click to select it"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"2. Choose Method:"})," Single episode, batch range, or all episodes"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"3. Scrape:"})," Click the scrape button and wait for results"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"4. Review:"})," Check the results and add episodes to your database"]})]})]}),P&&L&&x&&e.jsx(_,{isOpen:P,onClose:z,animeId:x.id,animeTitle:x.title,scrapedEpisodes:L.scrapedEpisodes||[],failedEpisodes:L.failedEpisodes||[],summary:L.summary||{total:0,successful:0,failed:0,embeddingProtected:0},onEpisodesAdded:()=>{z(),D("Episodes added successfully!"),setTimeout(()=>D(null),5e3)}})]})},k=Object.freeze(Object.defineProperty({__proto__:null,AnimeScraperComponent:A},Symbol.toStringTag,{value:"Module"}));export{m as A,g as E,v as H,_ as S,f as T,p as a,j as b,A as c,u as d,h as e,x as f,w as g,N as h,S as i,k as j};
//# sourceMappingURL=admin-I3YcsrSP.js.map
